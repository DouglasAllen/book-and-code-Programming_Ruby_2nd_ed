<html><title>Programming Ruby: The Pragmatic Programmer's Guide</title><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><STYLE TYPE="text/css"><!--
       BODY    { margin-left: 1in;
                 width: 6in;
                 font-family: helvetica, arial, sans-serif;
               }
       H1      { color: #000080;
                 font-family: helvetica, arial, sans-serif;
                 font-size: 22pt;
                 margin-left: 0in
               }
       H2      { color: #000080;  font: bold x-large helvetica, sans-serif;
                 margin-left: 0in }
       H3      { color: #000080;  font: bold   large helvetica, sans-serif; }
       H4      { color: #000080;  font: italic large helvetica, sans-serif; }
       .ruby   { background: #fff0f0 }
       .header { color: white }
       .subheader { color: #ffdddd }
       .sidebar   { width: 6in }
       span.sans { font-family: helvetica, arial, sans-serif }
       -->
   </STYLE><table bgcolor="#a03030" cellpadding="3" border="0" cellspacing="0"><tr><td colspan="3"><table bgcolor="#902020" cellpadding="20"><tr><td><h1 class="header">Programming Ruby</h1><h3 class="subheader">The Pragmatic Programmer's Guide</h3></td></tr></table></td></tr><tr><td width="33%" align="left"><a class="subheader" href="ref_c_class.html">Previous &lt;</a></td><td width="33%" align="center" valign="middle"><a class="subheader" href="builtins.html">Contents ^</a><br></td><td width="33%" align="right"><a class="subheader" href="ref_c_dir.html">Next ></a><br></td></tr></table></head><body bgcolor="white">
<!--
    Copyright (c) 2001 by Addison Wesley Longman.  This
    material may be distributed only subject to the terms and
    conditions set forth in the Open Publication License, v1.0 or
    later (the latest version is presently available at
    http://www.opencontent.org/openpub/).
-->
<table><tr><td height="20"><img src="dot.gif" width="1" height="20"></td></tr></table><table border="0" width="100%" bgcolor="660066" cellpadding="10"><tr><td valign="center"><font color="white" size="7">class Continuation</font></td><td><table border="0"><tr><td><font color="white">
                Parent:
              </font></td><td><font color="white">Object</font></td></tr><tr><td><font color="white">
                Version:
              </font></td><td><font color="white">
               1.6
              </font></td></tr></table></td></tr></table><p></p><H3>Index:</H3><a href="#call"><i>call</i></a> <p></p><hr>
<P></P>
  <code>Continuation</code> objects are generated by
  <a href="ref_m_kernel.html#callcc"><code>Kernel#callcc</code></a>. They hold a return address and execution
  context, allowing a nonlocal return to the end of the <code>callcc</code>
  block from anywhere within a program. Continuations are somewhat
  analogous to a structured version of C's <code>setjmp/longjmp</code>
  (although they contain more state, so you might consider them closer
  to threads).
<P></P>
  For instance:
<P></P>

<table bgcolor="#fff0f0" cellspacing="0" border="0" cellpadding="3" width="400"><tr><td><pre>
arr&nbsp;=&nbsp;[&nbsp;"Freddie",&nbsp;"Herbie",&nbsp;"Ron",&nbsp;"Max",&nbsp;"Ringo"&nbsp;]
callcc{|$cc|}
puts(message&nbsp;=&nbsp;arr.shift)
$cc.call&nbsp;unless&nbsp;message&nbsp;=~&nbsp;/Max/
</pre></td></tr></table>

<em>produces:</em>
<table bgcolor="#fff0f0" cellspacing="0" border="0" cellpadding="3" width="400"><tr><td><pre>
Freddie
Herbie
Ron
Max
</pre></td></tr></table>

<P></P>
  This (somewhat contrived) example  allows the inner loop to abandon
  processing early:
<P></P>

<table bgcolor="#fff0f0" cellspacing="0" border="0" cellpadding="3" width="400"><tr><td><pre>
callcc&nbsp;{|cont|
&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;0..4
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;"\n#{i}:&nbsp;"
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;i*5...(i+1)*5
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cont.call()&nbsp;if&nbsp;j&nbsp;==&nbsp;17
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf&nbsp;"%3d",&nbsp;j
&nbsp;&nbsp;&nbsp;&nbsp;end
&nbsp;&nbsp;end
}
print&nbsp;"\n"
</pre></td></tr></table>

<em>produces:</em>
<table bgcolor="#fff0f0" cellspacing="0" border="0" cellpadding="3" width="400"><tr><td><pre>
<P></P>
0:&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;1&nbsp;&nbsp;2&nbsp;&nbsp;3&nbsp;&nbsp;4
1:&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;6&nbsp;&nbsp;7&nbsp;&nbsp;8&nbsp;&nbsp;9
2:&nbsp;&nbsp;10&nbsp;11&nbsp;12&nbsp;13&nbsp;14
3:&nbsp;&nbsp;15&nbsp;16
</pre></td></tr></table>

<P></P>
  <table border="0" width="100%" cellpadding="10"><tr><td valign="center" colspan="2" bgcolor="990066"><font color="white" size="6">instance methods
       </font></td></tr><tr><td valign="center" bgcolor="#ff9999"><font size="4"><a name="call"><b>call</b></a></font></td><td bgcolor="#ffaaaa">
        <i>cont</i>.call( <i>[</i><i>args</i><i>]<sup>*</sup></i> )
      </td></tr><td></td><td>
<P></P>
      Invokes the continuation. The program continues from the end of
      the <code>callcc</code> block. If no arguments are given, the original
      <code>callcc</code> returns <code>nil</code>. If one argument is given,
      <code>callcc</code> returns it. Otherwise, an array containing
      <i>args</i> is returned.
<P></P>

<table bgcolor="#fff0f0" cellspacing="0" border="0" cellpadding="3" width="500">
<tr>
  <td valign="top"><code>callcc&nbsp;{|cont|&nbsp;&nbsp;cont.call&nbsp;}</code></td>
  <td valign="top">»</td>
  <td valign="top"><code>nil</code></td>
</tr>
<tr>
  <td valign="top"><code>callcc&nbsp;{|cont|&nbsp;&nbsp;cont.call&nbsp;1&nbsp;}</code></td>
  <td valign="top">»</td>
  <td valign="top"><code>1</code></td>
</tr>
<tr>
  <td valign="top"><code>callcc&nbsp;{|cont|&nbsp;&nbsp;cont.call&nbsp;1,&nbsp;2,&nbsp;3&nbsp;}</code></td>
  <td valign="top">»</td>
  <td valign="top"><code>[1,&nbsp;2,&nbsp;3]</code></td>
</tr>
</table>
<P></P>

<P></P>
      </td></table>
<P></P>

<p></p><hr><table bgcolor="#a03030" cellpadding="10" border="0" cellspacing="0"><tr><td width="33%" align="left"><a class="subheader" href="ref_c_class.html">Previous &lt;</a></td><td width="33%" align="center" valign="middle"><a class="subheader" href="builtins.html">Contents ^</a><br></td><td width="33%" align="right"><a class="subheader" href="ref_c_dir.html">Next ></a><br></td></tr></table><p></p><font size="-1">Extracted from the book "Programming Ruby -
     The Pragmatic Programmer's Guide"</font><br><font size="-3">
      Copyright
      &#169;
      2000 Addison Wesley Longman, Inc. Released under the terms of the
      <a href="http://www.opencontent.org/openpub/">Open Publication License</a> V1.0.
        <br>
      This reference is available for
        <a href="http://www.pragmaticprogrammer.com/ruby/downloads/book.html">download</a>.
   </font></body></html>